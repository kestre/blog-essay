---
title: JavaScript中的正则表达式
date: 2018-06-03 00:00:00
tag: [JavaScript,RegExp,note]
---
# 1.正则表达式的定义
## JavaScript中的正则表达式用RegExp对象表示
- 可以使用RegExp()构造函数来创建对象。以下代码定义了名为pattern的RegExp对象，其模式为"s"

```js
var pattern = new RegExp("s");
var pattern = new RegExp("s","i");
```
- 通过一种特殊的直接量语法创建（更多的使用）

```js
var pattern = /s/;
var pattern = /s/i;
```
## 直接量字符
- 正则表达式语法也支持非字母的字符匹配，这些字符需要通过反斜杠（ \ ）作为前缀进行转义。

字符|匹配
 :- | :- 
字母和数字字符|自身
\o|NUL字符（\u0000）
\t|制表符（\u0009）
\n|换行符（\u000A）
\v|垂直制表符（\u000B）
\f|换页符（\u000C）
\r|回车符（\u000D）
\xnn|由十六进制数nn指定的拉丁字符，例如，\x0A等价于\n
\uxxxx|由十六进制数xxxx指定的Unicode字符，例如，\u0009等价于\t
\cX|控制字符^X，例如，\cJ等价于换行符\n
## 字符类
- 将直接量字符单独放进方括号内就组成了字符类，一个字符类可以匹配它所包括的任意字符。

字符|匹配
 :- | :- 
[...]|方括号内的任意字符
[^...]|不在方括号内的任意字符
.|除换行符和其他Unicode行终止符之外的任意字符
\w|任何ASCII字符组成的单词，等价于[a-zA-Z0-9]
\W|任何不是ASCII字符组成的单词，等价于[^a-zA-Z0-9]
\s|任何Unicode空白符
\S|任何非Unicode空白符的字符，注意\w和\S不同
\d|任何ASCII数字，等价于[0-9]
\D|除了ASCII数字之外的任何字符，等价于[^0-9]
[\b]|退格直接量（特例）
- 注意：在反括号之内也可以写特殊转义字符。

## 重复
- 除了用 /\d\d/ , /\d\d\d\d/ 表示两位数和四位数，可以用 重复字符语法。

字符|匹配
 :- | :- 
{n,m}|匹配前一项至少n次，但不能超过m次
{n,}|匹配前一项n次或者更多次
{n}|匹配前一项n次
?|匹配前一项0次或者1次，也就是说前一项是可选的，等价于{0,1}
+|匹配前一项1次或多次，等价于{1，}
*|匹配前一项0次或多次，等价于{0，}
## 非贪婪的重复
### 贪婪
- 在上面列出的匹配重复字符是尽可能的多匹配，而且允许后续的正则表达式继续匹配。因此，我们称之为”贪婪的“匹配。
例如：

```js
"aaa".match(/a+/)
// ["aaa", index: 0, input: "aaa"]
//a+为一到多个a匹配 
```
### 非贪婪
- 我们同样可以使用正则表达式进行非贪婪匹配。只须在待匹配的字符后跟随一个问号即可：“??” 、“+?” 、“*?” 或 “{1,5}”。
例如：

```js
"aaa".match(/a+?/)
// ["a", index: 0, input: "aaa"]  
//加上?号后为非贪婪模式, 即匹配完成即返回, 不继续  
```
**注意：**正则是从左到右开始匹配所有项, 直到匹配为止。那么如下, 它匹配的就应该是整段字符, 而不是单独的一个b 
```js
"aaab".match(/a*?b/)
// ["aaab", index: 0, input: "aaab"] 
```
## 选择、分组和引用
### 选择
- 选择项的尝试匹配次序从左到右，知道发现了匹配项。如果左边的选择项匹配，就忽略右边的匹配项，即使他会产生更好的匹配。

```js
"ab".match(/a|ab/)
// ["a", index: 0, input: "ab"]
//它只匹配第一个字符
```
### 分组
- 使用（）把单独的项组合成子表达式，以便可以像处理一个独立的单元那样用 “ | ” 、“ * ” 、“ + ” 、“ ？” 等来对单元内的项进行处理。

```js
"abcdef".match(/(ab|cd)+|ef/)  
// ["abcd", "cd", index: 0, input: "abcdef"] 
```
- 在正则表达式中，圆括号的另一个作用是在完整的模式中定义子模式

**注意：**当一个正则表达式成功地和目标字符串相匹配时，可以从目标串中抽出和圆括号中的子模式相匹配的部分。例如：
```js
"aaa111".match(/[a-z]*\d/)
// ["aaa1", index: 0, input: "aaa111"] 
"aaa111".match(/[a-z]*(\d)/)
// ["aaa1", "1", index: 0, input: "aaa111"]  
```
### 引用
- 使用带圆括号的表达式允许在同一正则表达式的后部分引用前面的子表达式。通过在字符“\”后面加一位或多位数字来实现。

**注意：**数字指定了带圆括号的子表达式在正则表达式中的位置，是参与计数的左括号的位置。
**注意：**引用指的并不是模式的引用，而是指的是与那个模式相匹配的完全相同的字符。
```js
"a'aa1'11".match(/(['"])[^'"]*\1/)
// ["'aa1'", "'", index: 0, input: "a'aa1'11"]
```
- 在正则表达式中可以使用（？：）创建不带数字编码的引用。

字符|含义
 :- | :- 
&#124;|选择，匹配的是该符号左边的子表达式或右边的子表达式
(...)|组合，将几个项组合为一个单元，这个单元可通过 ”*“ 、”+“ 、”？“ 和 ”&#124;“ 等符号加以修饰，而且可以记住和这个组合相匹配的字符串以供此后的引用使用
(?...)|只组合，把项组合到一个单元，但不记忆与该组相匹配的字符
\n|和第n个分组第一次匹配的字符相匹配，组是圆括号中的子表达式（也有可能是嵌套的），组索引是从左到右的左括号数，”(?:“ 形式的分组不编码
## 指定匹配位置
- 正则表达式中的锚字符

字符|含义
 :- | :- 
^&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|匹配字符串的开头，在多行检索中，匹配一行的开头
$|匹配字符串的结尾，在多行结尾中，匹配一行的结尾
\b|匹配一个单词的边界，简言之，就是位于字符\w和\W之间的位置，或位于字符\w和字符串的开头或者结尾之间的位置（但需要注意，[\b]匹配的是退格符）
\B|匹配非单词边界的位置
(?=p)|零宽正向先行断言，要求接下来的字符都与p匹配，但不能包括匹配p的那些字符
(?!p)|零宽负向先行断言，要求接下来的字符不与p匹配
## 修饰符
- 用以说明高级匹配模式的规则。

**注意：**修饰符放在 ” / “ 符号之外的，也就是说，它们不是出现在两条斜线之间，而是第二条斜线之后。

字符|含义
 :- | :- 
i|执行不区分大小写的匹配
g|执行一个全局匹配，简言之，即找到所有的匹配，而不是在找到第一个之后就停止
m|多行匹配模式，^匹配一行的开头和字符串的开头，$匹配行的结束和字符串的结束
# 2.用于模式匹配的String方法
- 讨论String对象的一些用以执行正则表达式模式匹配和检索替换操作的方法

## search()
- 它的参数是一个正则表达式，返回第一个与之匹配的字串的起始位置

**注意：**如果找不到匹配的子串，它将返回-1。
**注意：**search()方法不支持全局检索，因此它忽略正则表达式参数中的修饰符g

```js
stringObject.search(regexp/substr)
```
参数|描述
 :- | :-
regexp/substr|必需。
```js
"JavaScript".search(/script/i);
// 返回值为 4
```
## replace()
- 用于在字符串中用一些字符替换另一些字符，或替换一个与正则表达式匹配的子串。

```js
stringObject.replace(regexp/substr,replacement)
```
参数|描述
 :- | :-
regexp/substr|必需。规定子字符串或要替换的模式的 RegExp 对象。请注意，如果该值是一个字符串，则将它作为要检索的直接量文本模式，而不是首先被转换为 RegExp 对象
replacement|必需。一个字符串值。规定了替换文本或生成替换文本的函数。
```js
"JavaScript".replace(/script/i, "SCRIPT");
// 返回值为 JavaSCRIPT
```
## match()
- match() 方法可在字符串内检索指定的值，或找到一个或多个正则表达式的匹配。

**注意：**该方法类似 indexOf() 和 lastIndexOf()，但是它返回指定的值，而不是字符串的位置。
```js
stringObject.match(searchvalue)
stringObject.match(regexp)
```
参数|描述
 :- | :-
searchvalue|必需。规定要检索的字符串值。
regexp|必需。规定要匹配的模式的 RegExp 对象。如果该参数不是 RegExp 对象，则需要首先把它传递给 RegExp 构造函数，将其转换为 RegExp 对象。
```js
"1 plus 2 equal 3".match(/\d+/g);
// 返回值为 ["1", "2", "3"] 的数组
```
## exec()
- 用于检索字符串中的正则表达式的匹配。

**注意：**返回一个数组，其中存放匹配的结果。如果未找到匹配，则返回值为 null。
```js
RegExpObject.exec(string)
```
参数|描述
 :- | :-
string|必需。要检索的字符串。
```js
/\d+/g.exec("1 plus 2 equal 3");
// 返回值为数组,属性 index：0 ，input: "1 plus 2 equal 3"
```

# 参考
- JavaScript权威指南（第六版）
- [w3school](http://www.w3school.com.cn/jsref/jsref_replace.asp)
- [贪婪模式详解](http://lullabyus.iteye.com/blog/1442347)
- [js正则表达式的选择、分组、引用](https://blog.csdn.net/qq_34356563/article/details/77844689)